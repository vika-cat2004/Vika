#include "parse.h"

#include <getopt.h>

int parse_params(int argc, char **argv, char *short_options,
                 const struct option *long_options, config *conf) {
  int res;  // –∑–∞–ø–∏—Å—ã–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
  int error = 0;
  int idx = 0;  // –∫—É–¥–∞ –±—É–¥–µ—Ç —Å–æ—Ö—Ä–∞–Ω –∏–Ω–¥–µ–∫—Å –Ω–∞–π–¥ –æ–ø—Ü–∏–∏, —Ç–µ–∫—É—â –ø–∞—Ä–∞–º–µ—Ç—Ä–∞, –≤
                // –º–∞—Å—Å–∏–≤–µ long_options

  while ((res = getopt_long(argc, argv, short_options, long_options, &idx)) !=
         -1) {
    // //getopt_long —Å—á–∏—Ç—ã–≤–∞–µ—Ç –≤—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ –æ—á–µ—Ä–µ–¥–∏ –∏ —Å—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç –∏—Ö —Å —Ç–µ–º–∏,
    // —á—Ç–æ –º—ã –ø–µ—Ä–µ–¥–∞–µ–º –≤ –∫–∞—á–µ—Å—Ç–≤–µ –æ–∂–∏–¥–∞–µ–º—ã—Ö.
    // - –ï—Å–ª–∏ –æ–Ω–∞ –≤—Å—Ç—Ä–µ—á–∞–µ—Ç –æ–∂–∏–¥–∞–µ–º—ã–π —Ñ–ª–∞–≥, —Ç–æ –æ–Ω–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –µ–≥–æ int
    // –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ
    // - –ï—Å–ª–∏ –≤—Å—Ç—Ä–µ—á–∞–µ—Ç—Å—è –Ω–µ –æ–∂–∏–¥–∞–µ–º—ã–π —Ñ–ª–∞–≥, —Ç–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è —Å–∏–º–≤–æ–ª ‚Äò?‚Äô
    // - –ï—Å–ª–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–∫–æ–Ω—á–∏–ª–∏—Å—å, —Ç–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è -1

    switch (res) {
      case 'b':
        conf->b = 1;
        break;
      case 'e':
        conf->e = 1;
        conf->v = 1;
        break;
      case 'E':
        conf->e = 1;
        break;
      case 'n':
        conf->n = 1;
        break;
      case 's':
        conf->s = 1;
        break;
      case 't':
        conf->t = 1;
        conf->v = 1;
        break;
      case 'T':
        conf->t = 1;
      case 'v':
        conf->v = 1;
        break;
      case '?':
        error = 1;
        break;
      default:
        error = 1;
        break;
    }
  }

  if (error) {
    return 1;
  }
  return 0;
}

// —Å—Ä–∞–≤–Ω –Ω–∞—à res —Å–æ –≤—Å–µ–≤–æ–∑–º–æ–∂ –≤–∞—Ä–∏–∞–Ω—Ç–∞–º–∏ –æ–∂–∏–¥–∞–µ–º—ã—Ö —Ñ–ª–∞–≥–æ–≤ –∏ –≤ —Ç–æ–∂–µ –≤—Ä–µ–º—è —Å–æ—Ö—Ä
// —Å–æ—Å—Ç–æ—è–Ω–∏–µ –Ω–∞—à–∏—Ö —Ñ–ª–∞–≥–æ–≤ –≤ –Ω–∞—à—É —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Åonf, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–∏—à–ª–∞ –∫ –Ω–∞–º –≤ —Ñ—É–Ω–∫—Ü–∏—é
// –ø–æ —Å—Å—ã–ª–∫–µ –∏–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Å–∞–º–æ–π —Ñ—É–Ω–∫—Ü–∏–∏.

// üìå –ó–∞–º–µ—Ç—å, –µ—Å–ª–∏ –Ω–µ –∑–Ω–∞–ª. –ï—Å–ª–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–∏—à–ª–∞ –∫ –Ω–∞–º –ø–æ —Å—Å—ã–ª–∫–µ, —Ç–æ –æ–±—Ä–∞—â–µ–Ω–∏–µ
// –∫ –µ–µ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–º –ø–æ–ª—è–º –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —á–µ—Ä–µ–∑ ‚Äú->‚Äù, –∞ –Ω–µ –∫–∞–∫ –æ–±—ã—á–Ω–æ, —á–µ—Ä–µ–∑
// ‚Äú.‚Äù(—Ç–æ—á–∫—É)